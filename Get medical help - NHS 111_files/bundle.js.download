!function(){var e,t={1215:function(e,t,n){"use strict";n(8579);var r,a,i="function"==typeof Map?new Map:(r=[],a=[],{has:function(e){return r.indexOf(e)>-1},get:function(e){return a[r.indexOf(e)]},set:function(e,t){-1===r.indexOf(e)&&(r.push(e),a.push(t))},delete:function(e){var t=r.indexOf(e);t>-1&&(r.splice(t,1),a.splice(t,1))}}),o=function(e){return new Event(e,{bubbles:!0})};try{new Event("test")}catch(r){o=function(e){var t=document.createEvent("Event");return t.initEvent(e,!0,!1),t}}function c(e){var t=i.get(e);t&&t.destroy()}function s(e){var t=i.get(e);t&&t.update()}var u=null;"undefined"==typeof window||"function"!=typeof window.getComputedStyle?((u=function(e){return e}).destroy=function(e){return e},u.update=function(e){return e}):((u=function(e,t){return e&&Array.prototype.forEach.call(e.length?e:[e],(function(e){return function(e){if(e&&e.nodeName&&"TEXTAREA"===e.nodeName&&!i.has(e)){var t,n=null,r=null,a=null,c=function(){e.clientWidth!==r&&l()},s=function(t){window.removeEventListener("resize",c,!1),e.removeEventListener("input",l,!1),e.removeEventListener("keyup",l,!1),e.removeEventListener("autosize:destroy",s,!1),e.removeEventListener("autosize:update",l,!1),Object.keys(t).forEach((function(n){e.style[n]=t[n]})),i.delete(e)}.bind(e,{height:e.style.height,resize:e.style.resize,overflowY:e.style.overflowY,overflowX:e.style.overflowX,wordWrap:e.style.wordWrap});e.addEventListener("autosize:destroy",s,!1),"onpropertychange"in e&&"oninput"in e&&e.addEventListener("keyup",l,!1),window.addEventListener("resize",c,!1),e.addEventListener("input",l,!1),e.addEventListener("autosize:update",l,!1),e.style.overflowX="hidden",e.style.wordWrap="break-word",i.set(e,{destroy:s,update:l}),"vertical"===(t=window.getComputedStyle(e,null)).resize?e.style.resize="none":"both"===t.resize&&(e.style.resize="horizontal"),n="content-box"===t.boxSizing?-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)):parseFloat(t.borderTopWidth)+parseFloat(t.borderBottomWidth),isNaN(n)&&(n=0),l()}function u(t){var n=e.style.width;e.style.width="0px",e.style.width=n,e.style.overflowY=t}function d(){if(0!==e.scrollHeight){var t=function(e){for(var t=[];e&&e.parentNode&&e.parentNode instanceof Element;)e.parentNode.scrollTop&&t.push({node:e.parentNode,scrollTop:e.parentNode.scrollTop}),e=e.parentNode;return t}(e),a=document.documentElement&&document.documentElement.scrollTop;e.style.height="",e.style.height=e.scrollHeight+n+"px",r=e.clientWidth,t.forEach((function(e){e.node.scrollTop=e.scrollTop})),a&&(document.documentElement.scrollTop=a)}}function l(){d();var t=Math.round(parseFloat(e.style.height)),n=window.getComputedStyle(e,null),r="content-box"===n.boxSizing?Math.round(parseFloat(n.height)):e.offsetHeight;if(r<t?"hidden"===n.overflowY&&(u("scroll"),d(),r="content-box"===n.boxSizing?Math.round(parseFloat(window.getComputedStyle(e,null).height)):e.offsetHeight):"hidden"!==n.overflowY&&(u("hidden"),d(),r="content-box"===n.boxSizing?Math.round(parseFloat(window.getComputedStyle(e,null).height)):e.offsetHeight),a!==r){a=r;var i=o("autosize:resized");try{e.dispatchEvent(i)}catch(e){}}}}(e)})),e}).destroy=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],c),e},u.update=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],s),e});var d,l=u;function h(e){var t,n,r=e.replace(/\s/g,""),a=(t=r,(n=[1,2,3,4,5,6,7,8,9].map((function(e){return t.lastIndexOf(e)})).sort((function(e,t){return e-t})))[n.length-1]);return-1===a?r:a<r.length-1?r.substring(0,a):r}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?document.querySelectorAll('[name$="'.concat(e,'"]')):document.getElementsByName(e);return n.length>0?n[0].value:""}function v(){var e=p("Gender",!0);return["male","female"].includes(e.toLowerCase())?e:""}function m(){var e=document.querySelector('input[value^="Dx"]');return e?e.value:""}function b(e,t,n,r){var a=new FormData,i=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return{journeyId:p("JourneyId"),campaign:p("Campaign"),dxCode:m(),postCodePart:h(p("CurrentPostcode",!0)),pathwayId:p("PathwayId",!0),pathwayTitle:p("PathwayTitle",!0),campaignSource:p("Source"),QuestionNo:p("QuestionNo"),QuestionTitle:p("Title"),age:p("Age",!0),gender:v(),eventKey:e,eventValue:t,page:window.location.pathname,AnswerOrder:n,AnswerTitle:r}}(e,t,n,r);Object.entries(i).forEach((function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,c=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){c=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(c)throw a}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e,2),n=t[0],r=t[1];a.append(n,r)})),navigator.sendBeacon&&navigator.sendBeacon("/Auditing/Log",a)}function y(e,t,n){b("Clicked",e,t,n)}function g(e){(function(e){if("A"!==e.tagName||!1===e.href)return!1;var t=document.querySelector(e.hash);if(!t)return!1;var n=function(e){var t=e.closest("fieldset");if(t){var n=t.getElementsByTagName("legend");if(n.length){var r=n[0];if("checkbox"===e.type||"radio"===e.type)return r;var a=r.getBoundingClientRect().top,i=e.getBoundingClientRect();if(i.height&&window.innerHeight&&i.top+i.height-a<window.innerHeight/2)return r}}return document.querySelector("label[for='".concat(e.getAttribute("id"),"']"))||e.closest("label")}(t);return!!n&&(n.scrollIntoView(),t.focus({preventScroll:!0}),!0)})(e.target)&&e.preventDefault()}jQuery((function(){var e=parseInt($(".feedback__input").attr("maxlength")),t=$(".feedback-more"),n=$(".feedback-choices"),r="field-validation-error",a="field-validation-valid",i=$("#feedback-error");function o(e){e?i.removeClass(r).addClass(a):i.addClass(r).removeClass(a)}$(".feedback__submit").prop("disabled","true"),$(".feedback__tell").prop("disabled","true"),$(".feedback__input").attr("maxlength",1.5*e),$(".feedback__input").on("keyup input",(function(){var t=$(this).val().length;(t=e-t)>=0?($(".feedback__counter").removeClass("feedback__counter--error").text(t+" characters remaining"),$(".feedback__submit").removeAttr("disabled")):($(".feedback__counter").addClass("feedback__counter--error").text(Math.abs(t)+" characters too many"),$(".feedback__submit").prop("disabled","true")),t==e&&$(".feedback__submit").prop("disabled","true")})),l($(".feedback__input")),function t(){$(".feedback__submit").one("click",(function(n){var r=$(".feedback__input"),a=parseInt(r.val().length),i=$.trim(r.val());if(a<=0||a>e||""===i)return o(!1),t(),n.preventDefault();o(!0)}))}(),$(".feedback__tell").one("click",(function(e){"No"==$("input[name=feedbackChoice]:checked").val()&&(t.addClass("feedback-more--open"),n.removeClass("feedback-choices--open"),e.preventDefault())})),$("input[name=feedbackChoice]").on("change",(function(e){var t=$(this).val();$(".feedback__tell").prop("disabled",!1).attr("data-event-value","Tell us "+t)})),$(".js-open-feedback").on("click",(function(e){$(".feedback details[open]").length||$(".feedback summary").click()}))})),n(7378),n(5354),n(2405),n(1930),window.logClick=y,window.logEvent=b,(d=document.querySelectorAll("[data-event-trigger=click]"))&&Array.from(d).forEach((function(e){e.addEventListener("click",(function(e){y(e.currentTarget.dataset.eventValue,e.currentTarget.dataset.eventAnswerOrder,e.currentTarget.dataset.eventAnswerTitle)}))}));var w=function(e,t){if(e&&t){var n="true"===e.getAttribute(t)?"false":"true";e.setAttribute(t,n)}},k=function(e,t){if(e&&t){var n=e.getAttribute("aria-controls");if(n){var r=document.getElementById(n);r&&(e.checked?(r.classList.remove(t),e.setAttribute("aria-expanded",!0)):(r.classList.add(t),e.setAttribute("aria-expanded",!1)))}}},x=function(e){e.form.querySelectorAll('input[type="checkbox"]').forEach((function(e){return k(e,"nhsuk-checkboxes__conditional--hidden")}))};function A(e,t,n,r){this.$module=e,this.namespace=t,this.responsive=n,this.historyEnabled=r,this.$tabs=e.querySelectorAll(".".concat(this.namespace,"__tab")),this.keys={down:40,left:37,right:39,up:38},this.jsHiddenClass="".concat(this.namespace,"__panel--hidden"),this.showEvent=new CustomEvent("tab.show"),this.hideEvent=new CustomEvent("tab.hide")}A.prototype.init=function(){"function"==typeof window.matchMedia&&this.responsive?this.setupResponsiveChecks():this.setup()},A.prototype.setupResponsiveChecks=function(){this.mql=window.matchMedia("(min-width: 40.0625em)"),this.mql.addListener(this.checkMode.bind(this)),this.checkMode()},A.prototype.checkMode=function(){this.mql.matches?this.setup():this.teardown()},A.prototype.setup=function(){var e=this,t=this.$module,n=this.$tabs,r=t.querySelector(".".concat(this.namespace,"__list")),a=t.querySelectorAll(".".concat(this.namespace,"__list-item"));if(n&&r&&a){r.setAttribute("role","tablist"),a.forEach((function(e){e.setAttribute("role","presentation")})),n.forEach((function(t){e.setAttributes(t),t.boundTabClick=e.onTabClick.bind(e),t.boundTabKeydown=e.onTabKeydown.bind(e),t.addEventListener("click",t.boundTabClick,!0),t.addEventListener("keydown",t.boundTabKeydown,!0),e.hideTab(t)}));var i=this.getTab(window.location.hash)||this.$tabs[0];this.showTab(i),this.historyEnabled&&(t.boundOnHashChange=this.onHashChange.bind(this),window.addEventListener("hashchange",t.boundOnHashChange,!0))}},A.prototype.teardown=function(){var e=this,t=this.$module,n=this.$tabs,r=t.querySelector(".".concat(this.namespace,"__list")),a=t.querySelectorAll(".".concat(this.namespace,"__list-item"));n&&r&&a&&(r.removeAttribute("role"),a.forEach((function(e){e.removeAttribute("role","presentation")})),n.forEach((function(t){t.removeEventListener("click",t.boundTabClick,!0),t.removeEventListener("keydown",t.boundTabKeydown,!0),e.unsetAttributes(t)})),this.historyEnabled&&window.removeEventListener("hashchange",t.boundOnHashChange,!0))},A.prototype.onHashChange=function(){var e=window.location.hash,t=this.getTab(e);if(t)if(this.changingHash)this.changingHash=!1;else{var n=this.getCurrentTab();this.hideTab(n),this.showTab(t),t.focus()}},A.prototype.hideTab=function(e){this.unhighlightTab(e),this.hidePanel(e)},A.prototype.showTab=function(e){this.highlightTab(e),this.showPanel(e)},A.prototype.getTab=function(e){return this.$module.querySelector(".".concat(this.namespace,'__tab[href="').concat(e,'"]'))},A.prototype.setAttributes=function(e){var t=this.getHref(e).slice(1);e.setAttribute("id","tab_".concat(t)),e.setAttribute("role","tab"),e.setAttribute("aria-controls",t),e.setAttribute("aria-selected","false"),e.setAttribute("tabindex","-1");var n=this.getPanel(e);n.setAttribute("role","tabpanel"),n.setAttribute("aria-labelledby",e.id),n.classList.add(this.jsHiddenClass)},A.prototype.unsetAttributes=function(e){e.removeAttribute("id"),e.removeAttribute("role"),e.removeAttribute("aria-controls"),e.removeAttribute("aria-selected"),e.removeAttribute("tabindex");var t=this.getPanel(e);t.removeAttribute("role"),t.removeAttribute("aria-labelledby"),t.removeAttribute("tabindex"),t.classList.remove(this.jsHiddenClass)},A.prototype.onTabClick=function(e){if(!e.target.classList.contains("".concat(this.namespace,"__tab")))return!1;e.preventDefault();var t=e.target,n=this.getCurrentTab();this.hideTab(n),this.showTab(t),this.createHistoryEntry(t)},A.prototype.createHistoryEntry=function(e){if(this.historyEnabled){var t=this.getPanel(e),n=t.id;t.id="",this.changingHash=!0,window.location.hash=this.getHref(e).slice(1),t.id=n}},A.prototype.onTabKeydown=function(e){switch(e.keyCode){case this.keys.left:case this.keys.up:this.activatePreviousTab(),e.preventDefault();break;case this.keys.right:case this.keys.down:this.activateNextTab(),e.preventDefault()}},A.prototype.activateNextTab=function(){var e,t=this.getCurrentTab(),n=t.parentNode.nextElementSibling;n&&(e=n.querySelector(".".concat(this.namespace,"__tab"))),e&&(this.hideTab(t),this.showTab(e),e.focus(),this.createHistoryEntry(e))},A.prototype.activatePreviousTab=function(){var e,t=this.getCurrentTab(),n=t.parentNode.previousElementSibling;n&&(e=n.querySelector(".".concat(this.namespace,"__tab"))),e&&(this.hideTab(t),this.showTab(e),e.focus(),this.createHistoryEntry(e))},A.prototype.getPanel=function(e){return this.$module.querySelector(this.getHref(e))},A.prototype.showPanel=function(e){var t=this.getPanel(e);t.classList.remove(this.jsHiddenClass),t.dispatchEvent(this.showEvent)},A.prototype.hidePanel=function(e){var t=this.getPanel(e);t.classList.add(this.jsHiddenClass),t.dispatchEvent(this.hideEvent)},A.prototype.unhighlightTab=function(e){e.setAttribute("aria-selected","false"),e.parentNode.classList.remove("".concat(this.namespace,"__list-item--selected")),e.setAttribute("tabindex","-1")},A.prototype.highlightTab=function(e){e.setAttribute("aria-selected","true"),e.parentNode.classList.add("".concat(this.namespace,"__list-item--selected")),e.setAttribute("tabindex","0")},A.prototype.getCurrentTab=function(){return this.$module.querySelector(".".concat(this.namespace,"__list-item--selected .").concat(this.namespace,"__tab"))},A.prototype.getHref=function(e){var t=e.getAttribute("href");return t.slice(t.indexOf("#"),t.length)};jQuery(".js-show").show(),jQuery(".js-hide").hide(),document.addEventListener("DOMContentLoaded",(function(){!function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).focusOnPageLoad,t=void 0===e||e,n=document.querySelector(".nhsuk-error-summary");n&&(t&&n.focus(),n.addEventListener("click",g))}(),function(){var e=document.querySelectorAll(".nhsuk-checkboxes .nhsuk-checkboxes__input"),t=function(e){var t;k(e.target,"nhsuk-checkboxes__conditional--hidden"),e.target.checked&&(e.target.hasAttribute("data-checkbox-exclusive")?((t=e.target).form.querySelectorAll('input[type="checkbox"][data-checkbox-exclusive-group="'.concat(t.getAttribute("data-checkbox-exclusive-group"),'"]')).forEach((function(e){t.form===e.form&&e!==t&&(e.checked=!1)})),x(t)):function(e){e.form.querySelectorAll('input[type="checkbox"][data-checkbox-exclusive][data-checkbox-exclusive-group="'.concat(e.getAttribute("data-checkbox-exclusive-group"),'"]')).forEach((function(t){e.form===t.form&&(t.checked=!1)})),x(e)}(e.target))};"onpageshow"in window?window.addEventListener("pageshow",(function(){return e.forEach((function(e){return x(e)}))})):window.addEventListener("DOMContentLoaded",(function(){return e.forEach((function(e){return x(e)}))})),e.forEach((function(e){return x(e)})),e.forEach((function(e){e.addEventListener("change",t)}))}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.namespace,n=void 0===t?"nhsuk-tabs":t,r=e.responsive,a=void 0===r||r,i=e.historyEnabled,o=void 0===i||i;document.querySelectorAll('[data-module="'.concat(n,'"]')).forEach((function(e){new A(e,n,a,o).init()}))}({namespace:"app-image-gallery",responsive:!1,historyEnabled:!1}),function(){if("boolean"!=typeof document.createElement("details").open){var e=document.querySelectorAll("details");e.length&&e.forEach((function(e,t){e.hasAttribute("nhsuk-polyfilled")||function(e,t){e.setAttribute("nhsuk-polyfilled","true"),e.id||e.setAttribute("id","nhsuk-details".concat(t));var n=document.querySelector("#".concat(e.id," .nhsuk-details__text"));n.id||n.setAttribute("id","nhsuk-details__text".concat(t));var r=document.querySelector("#".concat(e.id," .nhsuk-details__summary"));r.setAttribute("role","button"),r.setAttribute("aria-controls",n.id),r.setAttribute("tabIndex","0"),1==(null!==e.getAttribute("open"))?(r.setAttribute("aria-expanded","true"),n.setAttribute("aria-hidden","false")):(r.setAttribute("aria-expanded","false"),n.setAttribute("aria-hidden","true"),n.style.display="none"),r.addEventListener("click",(function(){w(r,"aria-expanded"),w(n,"aria-hidden"),n.style.display="true"===n.getAttribute("aria-hidden")?"none":"",e.hasAttribute("open")?e.removeAttribute("open"):e.setAttribute("open","open")})),r.addEventListener("keydown",(function(e){13!==e.keyCode&&32!==e.keyCode||(e.preventDefault(),r.click())}))}(e,t)}))}}()}))},7378:function(){jQuery((function(){$(".card__directions--fallback").hide(),$(".card__directions").show();var e=$("details:not([open])").has(".cards--goto");function t(){var e=document.createElement("iframe");e.src="/map/",e.setAttribute("role","presentation"),e.className+=" service-map",$(e).insertBefore(".cards--goto"),$(e).one("load",(function(){$(".cards--goto .card, .cards--goto .card__marker-link").css("display","block"),$(".cards--goto .card, .cards--goto .card__marker-link").on("click",(function(){var e=$(this).data("index");null==e&&(e=$(this).parent().data("index")),setActive(e),$("iframe")[0].contentWindow.frames.setActive(e)})),$(e).show(),$(e)[0].contentWindow.frames.initialise(mapServices,currentPostcode)}))}e.length?e.one("click",t):$(".cards--goto").length&&t(),window.viewMaps=function(e){$(".card[data-index="+e+"] form").submit()},window.setActive=function(e){$(".cards--goto .card").attr("style",""),$($(".cards--goto .card")[e]).attr("style","border-color: #005eb8;")},window.getDirections=function(e){var t=$(".card[data-index=".concat(e,"] form")).serializeArray(),n={};t.map((function(e,t){n[e.name]=e.value})),$.ajax({url:location.origin+"/Outcome/LogSelectedService",data:n,method:"POST"})},$(".card__directions").on("click",(function(e){getDirections($(this).parents(".card").data("index"))}))}))},5354:function(){jQuery((function(){if(0!=$(".service-details__map").length){var e=$(".service-listing:not([open])").has(".service-details__map");e.length&&e.one("click",n);var t=$(".service-listing[open] .service-details__map");1==t.length&&n(t[0]),$(".service-details__map:not(.service-listing .service-details__map)").toArray().forEach((function(e){return n(e)}))}function n(e){var t=e.currentTarget?$(".service-details__map",this)[0]:e,n=t.getAttribute("data-id"),r=document.createElement("iframe");r.src="/map/",r.setAttribute("role","presentation"),r.className+=" service-map",$(t).replaceWith(r),$(r).one("load",(function(){$(r).show(),$(r)[0].contentWindow.frames.initialise(mapServices[n],currentPostcode)}))}}))},2405:function(){jQuery(document).ready((function(){var e={},t={},n="QID1",r=null,a={};function i(r){n=r;var a=e[r].title,i=e[r].choices;$("#microSurveyQuestions").empty(),formGroupElement='<div class="form-group">',formGroupElement+='<h3 class="nhsuk-heading-m nhsuk-u-margin-bottom-3">'.concat(a,"</h3>"),i.forEach((function(e){var n=e.choiceText.split(" ").join(""),r=e.choiceId,a=e.inputType;if(!e.showIfServiceType||e.showIfServiceType.includes(t.rec_service_dos_type)){var i=e.showTextFieldID?'data-reveals-textbox-id="'.concat(e.showTextFieldID,'"'):"",o=e.showTextFieldID?'\n            <div class="micro-survey__toggle-element panel nhsuk-u-padding-top-2 nhsuk-u-padding-bottom-2 nhsuk-u-margin-left-3">\n              <label for="'.concat(e.showTextFieldID,'">\n                  ').concat(e.textFieldLabel,'\n              </label>\n              <input type="text" id="').concat(e.showTextFieldID,'" value="" maxLength="1000">\n            </div>\n        '):"";formGroupElement+='\n          <div class="nhsuk-u-margin-bottom-3">\n            <input type="'.concat(a,'" ').concat(i,' id="').concat(n,'" name="choice" value="').concat(r,'">\n            <label for="').concat(n,'">\n                ').concat(e.choiceText,"\n            </label>\n            ").concat(o,"\n          </div>\n      ")}})),formGroupElement+="</div>",$("#microSurveyQuestions").append(formGroupElement),$("#microSurveyQuestions").append('<button class="button--next" id="microSurveyNext" type="submit" name="Next" value="Next">Next</button>'),"QID1"!=n&&$("#microSurveyQuestions").append('<button class="button--link nhsuk-u-margin-top-4" id="microSurveyPrevious" type="button">Change my previous answer</button>')}window.startMicroSurvey=function(o,c){$("#microSurveyLink").hide(),$("#microSurveyQuestions").show(),$(".micro-survey--offering").removeClass("micro-survey--offering");var s=Date.now();e=o,t=c,i("QID1"),$("#microSurveyQuestions").on("click","[data-reveals-textbox-id]",(function(){var e=$(this).attr("data-reveals-textbox-id");$("#".concat(e)).show()})),$("#microSurveyQuestions").on("click","#microSurveyPrevious",(function(){r&&i(r)})),$("#microSurveyQuestions").on("submit",(function(){var o=function(t){var n=e[t],r=$("#microSurveyQuestions input:checked");if(0===r.length)return!1;if("Number"===n.answerType)return Number(r.val());if("[Number]"===n.answerType){var i=[];return r.each((function(){i.push($(this).val());var e=$(this).attr("data-reveals-textbox-id");e&&(a[e]=$("#".concat(e)).val())})),i}}(n);if(o){a[n]=o,r=n;var c,u=function(n,r){var a,i=r instanceof Array?r:[r],o=e[n];return i.forEach((function(e){var n=o.choices.filter((function(t){return t.choiceId===Number(e)}));n.length>1&&(n=n.filter((function(e){return e.showIfServiceType.includes(t.rec_service_dos_type)}))),n.length&&n[0].nextQuestionID&&(a=n[0].nextQuestionID)})),a}(n,o);if(u)i(u);else{var d=Date.now()-s,l=Math.floor(d/1e3);t.Q_TotalDuration=l,t.progress=100,$("#microSurveyQuestions").hide(),$("#microSurveyEnd").show();var h=Object.assign(a,t);c={values:JSON.stringify(h)},$.ajax({url:"/microsurvey/PostRecommendedServiceSurvey",method:"POST",contentType:"application/json",data:JSON.stringify(c),error:function(){window.logEvent("Error","Micro survey failed")}})}}else 0===$("#onlySelectOneOption").length&&($("#microSurveyQuestions .form-group").addClass("form-group-error"),$("#microSurveyQuestions h3").after('<span class="field-validation-error error-message nhsuk-u-margin-bottom-4" id="onlySelectOneOption" role="alert">You must select one option</span>'),$("#microSurveyQuestions input[type='checkbox'], #microSurveyQuestions input[type='radio']").attr("aria-invalid","true"))}))}}))},1930:function(e,t,n){n.g.$=n.g.jQuery=n(9755);var r=[],a=[];$(".service-listing").on("click",(function(e){u($(e.target))}));var i=function(e){e.attr("hidden",!0)},o=function(e){e.removeAttr("hidden")},c=function(e){var t=$("[data-service-action='bookAndGo']",e),n=$("[data-service-action='directions']",e);if("True"===$("[name='bookAndGoAvailable']",e).val()){o(t);var r=$("[name='SelectedServiceId']",e).val();window.logEvent("ArrivalTimesOffered",'{"ServiceId":"'+r+'"}')}else o(n)},s=function(e,t){i($(".spinner",e)),c(e),a.push(t)},u=function(e){var t={},n=e.closest(".service-listing"),u=$("[name='displayDirections']",n).val(),d=$("[name='otherServiceWithSchedulingAvailability']",n).val(),l=$("[name='firstService']",n).val(),h=$("[name='SelectedServiceId']",n).val(),f=$("[name='JourneyId']",n).val(),p=$("[name='searchEndDateTime']",n).val(),v=$("[name='searchStartDateTime']",n).val(),m=$(".service-details--actions",n),b=$("[data-service-action='bookSlot']",n),y=$("[data-service-action='bookAndGo']",n),g=$("[data-service-action='directions']",n),w=$(".spinner",n);if(a.indexOf(h)>-1)c(n);else if(r.indexOf(h)>-1)o(b);else{if("True"===l)return!1;if(i(g),i(b),i(y),"True"===u)o(g);else if("True"===d){!function(e){e.attr("aria-busy",!0)}(m),o(w);var k=$(location).attr("protocol")+"//"+$(location).attr("host")+"/appointments/getslots";t.dosServiceId=h,t.journeyId=f,t.searchStartDateTime=v,t.searchEndDateTime=p,$.ajax({dataType:"text",type:"GET",url:k,data:t,success:function(e){try{e=JSON.parse(e)}catch(e){return void s(n,h)}e.length>0?(i(w),function(e){e.attr("aria-busy",!1)}(m),o(b),r.push(h),window.logEvent("BookingOffered",'{"ServiceId":"'+h+'"}')):s(n,h)},error:function(){s(n,h)}})}}}},8579:function(){!function(e){var t="unobtrusiveAjaxClick",n="unobtrusiveAjaxClickTarget";function r(e,t){for(var n=window,r=(e||"").split(".");n&&r.length;)n=n[r.shift()];return"function"==typeof n?n:(t.push(e),Function.constructor.apply(null,t))}function a(e){return"GET"===e||"POST"===e}function i(e,t){a(t)||e.setRequestHeader("X-HTTP-Method-Override",t)}function o(t,n,r){var a;-1===r.indexOf("application/x-javascript")&&(a=(t.getAttribute("data-ajax-mode")||"").toUpperCase(),e(t.getAttribute("data-ajax-update")).each((function(t,r){switch(a){case"BEFORE":e(r).prepend(n);break;case"AFTER":e(r).append(n);break;case"REPLACE-WITH":e(r).replaceWith(n);break;default:e(r).html(n)}})))}function c(t,n){var c,s,u,d;if(!(c=t.getAttribute("data-ajax-confirm"))||window.confirm(c)){s=e(t.getAttribute("data-ajax-loading")),d=parseInt(t.getAttribute("data-ajax-loading-duration"),10)||0,e.extend(n,{type:t.getAttribute("data-ajax-method")||void 0,url:t.getAttribute("data-ajax-url")||void 0,cache:"true"===(t.getAttribute("data-ajax-cache")||"").toLowerCase(),beforeSend:function(e){var n;return i(e,u),!1!==(n=r(t.getAttribute("data-ajax-begin"),["xhr"]).apply(t,arguments))&&s.show(d),n},complete:function(){s.hide(d),r(t.getAttribute("data-ajax-complete"),["xhr","status"]).apply(t,arguments)},success:function(e,n,a){o(t,e,a.getResponseHeader("Content-Type")||"text/html"),r(t.getAttribute("data-ajax-success"),["data","status","xhr"]).apply(t,arguments)},error:function(){r(t.getAttribute("data-ajax-failure"),["xhr","status","error"]).apply(t,arguments)}}),n.data.push({name:"X-Requested-With",value:"XMLHttpRequest"}),a(u=n.type.toUpperCase())||(n.type="POST",n.data.push({name:"X-HTTP-Method-Override",value:u}));var l=e(t);if(l.is("form")&&"multipart/form-data"==l.attr("enctype")){var h=new FormData;e.each(n.data,(function(e,t){h.append(t.name,t.value)})),e("input[type=file]",l).each((function(){var t=this;e.each(t.files,(function(e,n){h.append(t.name,n)}))})),e.extend(n,{processData:!1,contentType:!1,data:h})}e.ajax(n)}}e(document).on("click","a[data-ajax=true]",(function(e){e.preventDefault(),c(this,{url:this.href,type:"GET",data:[]})})),e(document).on("click","form[data-ajax=true] input[type=image]",(function(n){var r=n.target.name,a=e(n.target),i=e(a.parents("form")[0]),o=a.offset();i.data(t,[{name:r+".x",value:Math.round(n.pageX-o.left)},{name:r+".y",value:Math.round(n.pageY-o.top)}]),setTimeout((function(){i.removeData(t)}),0)})),e(document).on("click","form[data-ajax=true] :submit",(function(r){var a=r.currentTarget.name,i=e(r.target),o=e(i.parents("form")[0]);o.data(t,a?[{name:a,value:r.currentTarget.value}]:[]),o.data(n,i),setTimeout((function(){o.removeData(t),o.removeData(n)}),0)})),e(document).on("submit","form[data-ajax=true]",(function(r){var a,i=e(this).data(t)||[],o=e(this).data(n),s=o&&(o.hasClass("cancel")||void 0!==o.attr("formnovalidate"));r.preventDefault(),(s||!(a=e(this).data("unobtrusiveValidation"))||!a.validate||a.validate())&&c(this,{url:this.action,type:this.method||"GET",data:i.concat(e(this).serializeArray())})}))}(jQuery)}},n={};function r(e){var a=n[e];if(void 0!==a)return a.exports;var i=n[e]={exports:{}};return t[e].call(i.exports,i,i.exports,r),i.exports}r.m=t,e=[],r.O=function(t,n,a,i){if(!n){var o=1/0;for(d=0;d<e.length;d++){n=e[d][0],a=e[d][1],i=e[d][2];for(var c=!0,s=0;s<n.length;s++)(!1&i||o>=i)&&Object.keys(r.O).every((function(e){return r.O[e](n[s])}))?n.splice(s--,1):(c=!1,i<o&&(o=i));if(c){e.splice(d--,1);var u=a();void 0!==u&&(t=u)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[n,a,i]},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={296:0};r.O.j=function(t){return 0===e[t]};var t=function(t,n){var a,i,o=n[0],c=n[1],s=n[2],u=0;if(o.some((function(t){return 0!==e[t]}))){for(a in c)r.o(c,a)&&(r.m[a]=c[a]);if(s)var d=s(r)}for(t&&t(n);u<o.length;u++)i=o[u],r.o(e,i)&&e[i]&&e[i][0](),e[o[u]]=0;return r.O(d)},n=self.webpackChunknhs_111=self.webpackChunknhs_111||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var a=r.O(void 0,[592],(function(){return r(1215)}));a=r.O(a)}();
//# sourceMappingURL=bundle.js.map